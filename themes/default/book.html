{% extends "layout.html" %}

{% set date_format = "m/d/Y"|trans %}
{% set authorBooks = book.getOtherBooksFromAuthor() %}
{% set files = book.getFiles() %}

{% block mainBody %}
<div id="book_detail">

    <div id="cover">
        {% if book.getCover().getThumbnailPath() %}
            <img src="{{ book.getCover().getThumbnailPath() }}" />
        {% endif %}
    </div>

    <div id="infos">
        <h1>{{ book.getTitle() }}</h1>
        <p>{{"Author:"|trans}} <span class="bold">{{ book.getAuthor().getName() }}</span></p>
        <p>{{"Publication date:"|trans}} <span class="bold">{{ book.getPubdate()|date(date_format) }}</span></p>

        {% if book.getSerie().getId() %}
        <p>{{"Serie:"|trans}} <span class="bold">{{ book.getSerie().getName()}}</span><br />
            <span class="small">{{"Download whole serie (%s books) as archive:"|trans|format(book.getSerie().getNumberOfBooks()) }}
            <a href="{{ app.url_generator.generate('serie_download', {id: book.getSerie().getId(), format: "zip"}) }}">zip</a> /
            <a href="{{ app.url_generator.generate('serie_download', {id: book.getSerie().getId(), format: "tar.gz"}) }}">tar.gz</a></span>
        </p>
        {% endif %}


        {% if files %}
            {% for file in files %}
            <p></p><a href="{{ app.url_generator.generate('book_download', {id: book.getId(), format: file.getFormat()}) }}" class="" title="{{ "Download"|trans }} {{file.getFormat()}}">
            {{ "Download in %s format (%s)"|trans|format(file.getFormat(), file.getFormattedSize()) }}
            </a></p>
            {% endfor %}
        {% endif %}

    </div>

    {% if book.getSerie().getId() %}
        {% set serieBooks = book.getOtherBooksFromSerie() %}
        {%if serieBooks|length > 0 %}
    <div id="serie">
        {{"Other books in this serie:"|trans}} <br />
        <ul>
            {% for serieBook in serieBooks %}
            <li>{% include 'book_link.html' with {'book': serieBook, 'showAuthor': false} %}</li>
            {% endfor %}
        </ul>
    </div>

        {% endif %}
    {% endif %}

    {% if authorBooks|length %}
    <div id="author">
        {{"Other books from this author:"|trans}} <br />
        <ul>
        {% for authorBook in authorBooks %}
            <li>{% include 'book_link.html' with {'book': authorBook, 'showAuthor': false} %}</li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}

</div>
{% endblock %}